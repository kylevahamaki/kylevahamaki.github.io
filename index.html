<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Simple AR Text Viewer</title>
    <meta
      name="description"
      content="Lightweight AR.js demo that shows two text labels anchored to a printed marker."
    />
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
      crossorigin
    />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@3.4.2/aframe/build/aframe-ar.js"></script>
    <style>
      :root {
        color-scheme: dark;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        background: #0c0f17;
        color: #f2f4ff;
        min-height: 100vh;
      }

      a {
        color: #4aa8ff;
      }

      .overlay {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: clamp(1.5rem, 4vw, 3rem);
        text-align: center;
        gap: 1.25rem;
        background: radial-gradient(circle at top, rgba(74, 168, 255, 0.18),
            transparent 55%),
          #0c0f17;
        z-index: 2;
        transition: opacity 180ms ease;
      }

      .overlay.hide {
        pointer-events: none;
        opacity: 0;
      }

      .overlay h1 {
        margin: 0;
        font-size: clamp(1.9rem, 4vw, 2.4rem);
      }

      .overlay p {
        margin: 0;
        max-width: 52ch;
        color: rgba(242, 244, 255, 0.76);
        line-height: 1.6;
      }

      .overlay .hint {
        font-size: 0.95rem;
        color: rgba(242, 244, 255, 0.62);
      }

      code {
        font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo,
          Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        background: rgba(15, 20, 32, 0.8);
        padding: 0.1rem 0.4rem;
        border-radius: 0.4rem;
      }

      .overlay button {
        border: none;
        border-radius: 999px;
        padding: 0.85rem 2.6rem;
        font-size: 1rem;
        font-weight: 600;
        background: linear-gradient(135deg, #4aa8ff, #6f6bff);
        color: #05070f;
        cursor: pointer;
        transition: transform 150ms ease, box-shadow 150ms ease;
        box-shadow: 0 14px 34px rgba(81, 110, 255, 0.35);
      }

      .overlay button:focus-visible,
      .overlay button:hover {
        transform: translateY(-1px);
        box-shadow: 0 18px 42px rgba(81, 110, 255, 0.4);
      }

      .status {
        position: fixed;
        left: 50%;
        bottom: clamp(1rem, 4vw, 2.5rem);
        transform: translateX(-50%);
        padding: 0.6rem 1.2rem;
        border-radius: 999px;
        background: rgba(12, 15, 23, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.12);
        font-size: 0.95rem;
        font-weight: 500;
        letter-spacing: 0.01em;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        z-index: 1;
        transition: opacity 180ms ease;
      }

      .status.hide {
        opacity: 0;
      }

      a-scene {
        width: 100vw;
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <div class="overlay" id="intro">
      <h1>Two-sided AR text marker</h1>
      <p>
        Print the
        <a href="assets/marker.png" download>reference card</a>, place it on a flat
        surface, and point your camera at it. As you circle the marker, the second
        label becomes visible on the reverse side of the floating card.
      </p>
      <p class="hint">
        Need custom text? Add
        <code>?front=Hello&back=World</code> to the URL before loading the page.
      </p>
      <button id="start-ar" type="button">Enable camera</button>
    </div>

    <div class="status" id="status">Waiting for camera...</div>

    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      renderer="logarithmicDepthBuffer: true; colorManagement: true"
      arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false"
    >
      <a-marker type="pattern" url="assets/marker.patt">
        <a-entity position="0 0 0" rotation="-90 0 0">
          <a-plane
            width="0.6"
            height="0.35"
            color="#101525"
            material="opacity: 0.92"
            position="0 0 0"
          ></a-plane>

          <a-text
            id="text-front"
            value="Front label"
            color="#f7f8ff"
            align="center"
            width="1.8"
            position="0 0 0.02"
          ></a-text>

          <a-text
            id="text-back"
            value="Back label"
            color="#f7f8ff"
            align="center"
            width="1.8"
            position="0 0 -0.02"
            rotation="0 180 0"
          ></a-text>
        </a-entity>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const intro = document.getElementById("intro");
      const status = document.getElementById("status");
      const startButton = document.getElementById("start-ar");
      const scene = document.querySelector("a-scene");
      const marker = document.querySelector("a-marker");
      const frontLabel = document.getElementById("text-front");
      const backLabel = document.getElementById("text-back");

      const setStatus = (message, hideAfter = false) => {
        status.textContent = message;
        status.classList.remove("hide");
        if (hideAfter) {
          setTimeout(() => status.classList.add("hide"), hideAfter);
        }
      };

      startButton.addEventListener("click", () => {
        intro.classList.add("hide");
        setStatus("Requesting camera access...");
        // On some browsers the scene needs a tick before the camera feed starts.
        setTimeout(() => {
          const arSystem = scene.components && scene.components.arjs;
          if (arSystem && typeof arSystem.start === "function") {
            arSystem.start();
          }
        }, 100);
      });

      const params = new URLSearchParams(window.location.search);
      const frontText = params.get("front");
      const backText = params.get("back");
      if (frontText) {
        frontLabel.setAttribute("value", frontText);
      }
      if (backText) {
        backLabel.setAttribute("value", backText);
      }

      scene.addEventListener("camera-init", () => {
        setStatus("Point the camera at the marker");
      });

      scene.addEventListener("camera-error", () => {
        setStatus("Camera unavailable. Check permissions and reload.");
      });

      marker.addEventListener("markerFound", () => {
        setStatus("Marker tracked â€” walk around to view both sides.", 2000);
      });

      marker.addEventListener("markerLost", () => {
        setStatus("Marker lost. Re-centre the reference card.");
      });
    </script>
  </body>
</html>
